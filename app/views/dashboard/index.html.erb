<% content_for(:title, 'Dashboard') %>

<div class="container mt-5">
  <div class="row">
    <div class="col-md-5 ps-5">
      <h1>Good Morning<%if user_signed_in? %>, <%= @user.full_name %><% end %></h1>
      <p class="lead">Welcome to your dashboard</p>
    </div>
    <!-- Announcement Column -->
    <div class="col-md-7">
      <h4 class="mb-4">Latest Announcements</h4>
      <div class="announcement-panel" style="max-height: 40%; overflow-y: scroll;">
        <% @announcements.each do |announcement| %>
          <div class="announcement-container bg-info-subtle rounded shadow-lg p-4 mb-3">
            <div class="d-flex align-items-start">
              <div class="d-flex align-items-center justify-content-center bg-secondary" style="width: 60px; border-radius: 50%; overflow: hidden; margin-right: 2%">
                <%= image_tag User.find_by(uid: announcement.googleUserID).avatar_url, alt: "User Avatar", style: 'width: 100%; height: auto;' %>
              </div>
              <div class="flex-grow-1">
                <h5 class="mb"> <%= announcement.subject %></h5>
              </div>
            </div>
            <p class="announcement-date text-muted mb-1">Posted on: <%= announcement.dateOfAnnouncement.in_time_zone.strftime("%b %d, %Y, %I:%M %p %Z") %></p>
            <p class="announcement-content mb-0">
              <%= truncate_with_link(announcement.body, 100, announcement_path(announcement)) %>
            </p>
          </div>
        <% end %>
      <div>
    </div>
  </div>
  <div class="events-container bg-white rounded shadow-lg p-4">
    <h4 class="mb-4">Upcoming Events</h4>
    <ul class="list-unstyled">
      <% @events.sort_by(&:eventTime).each do |event| %>
        <li class="mb-3">
          <div class="event-date text-primary mb-1">
            <strong><%= event.eventTime.strftime("%A, %B %-d") %></strong>
          </div>
          <div class="d-flex justify-content-between align-items-start">
            <div class="event-details">
              <h5 class="event-title mb-1"><%= event.eventName %></h5>
              <p class="event-time text-muted mb-0"><%= event.eventTime.strftime("%H:%M") %></p>
              <p class="event-location text-muted"><%= event.eventLocation %></p>
            </div>
            <a href="/rsvp?event_id=<%= event.id %>" class="btn btn-primary mt-2">RSVP</a>
          </div>
        </li>
      <% end %>
    </ul>
  </div>
  <div class="points-summary-container mt-5 p-4 bg-white rounded shadow-lg text-center">
    <h4 class="mb-4">Points Summary</h4>
    <div class="total-points-display mt-3">
      <h2 class="total-points">Total Points: <span class="points-value">150</span></h2>
    </div>
  </div>


</div>
  </div>
</div>
<% content_for(:extra_js) do %>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

<% end %>
